# Программа для проверки введённого пароля
## 1. О программе 
Программа написана на ассемблере. При запуске просит пользователя ввести пароль. Считывает введённый пароль с консоли, помещает строку в отведённый буфер, затем сравнивает с правильным паролем (Password). Сравнение производится двумя способами:
* С помощью функции StrCmp, похожей на аналогичную функцию C, сравнивающей строки посимвольно. Функция возвращает 1, если строки совпали, 0 – в противном случае (Важно! В данный момент эта проверка не используется для добавления уязвимости в программу).
* С помощью подсчёта хэш-суммы введённой строки. Хэш сумма считается следующим образом: сначала подсчитывается сумма ASCII-кодов символов введённой строки. Затем подсчитывается сумма остатков  от деления этих ASCII-кодов, умножается на 8 и добавляется к предыдущей сумме.
По результатам сравнения программа выводит надпись “Allowed” (от английского “доступ разрешён” –  “access is allowed”), если введённый пароль совпадает с верным, и “Denied ” (от английского “доступ запрещён” – “access is denied”), если введённый пароль неверный.  

## 2. Уязвимости
В учебных целях в программе предусмотрены две уязвимости, позволяющие добиться “разрешения доступа”, то есть выведения на экран надписи “Allowed” даже при неверном пароле.
### 1. Первая уязвимость
Первая уязвимость заключается в отключении StrCmp и сравнении строк исключительно подсчётом хэш-суммы. В таком случае “доступ” может быть получен при введении неверного пароля с той же хэш-суммой (например, этого же пароля в обратном порядке: _abobA_ вместо _Aboba_ или совершенно другого набора символов, напрмер (с данной хэш-суммой), _;;;;;;;_).
### 2. Вторая уязвимость
Вторая уязвимость связана с переполнением буфера. Так, при считывании строки с консоли максимальная допустимая длина строки – 100 символов, в то время как в действительности для буфера выделено 10 байт, из которых первые два отвечают за максимальную возможную длину строки и фактическую длину введённой строки, то есть на самом деле без потери следующих за буфером данных ввести можно только 8 символов! Таким образом, если ввести 10 произвольных символов, затем слово Please и пробел за ним (например, _0123456789Please _), в консоли выведется надпись “Allowed”. Это произойдёт по следующим причинам: первые 10 символов заполнят буфер, выделенный для введённого пароля. Слово “Please” имеет такую же длину, как слово “Denied”, поэтому вместе с пробелом оно полностью “затирает” место в памяти, занятое строкой “Denied$” ($ - символ конца строки, важно “затереть” и его тоже, чтобы последующая надпись “Allowed” всё-таки напечаталась). Таким образом, введённый пароль будет считаться неверным, программа соберётся распечатать слово “Denied”, но вместо него распечатается слово “Please”, расположенное в памяти по этому адресу (оно “наложится” на уже напечатанное в консоли “Please” в начале запроса, так что подмену строк никто не заподозрит ;) ). Из-за отсутствия символа конца строки выведется и идущее следующим в памяти “Allowed”. 

## 3. Попытки взлома
